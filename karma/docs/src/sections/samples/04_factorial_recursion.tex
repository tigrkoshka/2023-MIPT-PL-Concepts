\subsection{Calculate the factorial of a number using recursion}

\asmsample{

    \St{fact:}                 & ; a recursive function calculating the factorial of its argument     \\
    \qquad \St{loadr r0 r14 1} & ; load the first (and only) argument to \St{r0}                      \\
    \qquad \St{cmpi r0 1}      & ; compare \St{r0} to \St{1}                                          \\
    \qquad \St{jg skip0}       & ; if the argument is greater that \St{1}, recurse                    \\
    \qquad \St{lc r0 1}        & ; else store \St{1} (the result for this case, $1! = 1$) to \St{r0}  \\
    \qquad \St{ret 1}          & ; return from function and remove the argument from the stack        \\

    &                                                                      \\

    \St{skip0:}                & ; a supplemental function providing recursion                        \\
    \qquad \St{push r0 0}      & ; push the current value to the stack ($\star$)                      \\
    \qquad \St{subi r0 1}      & ; decrement the current value by \St{1}                              \\
    \qquad \St{push r0 0}      & ; push the decremented value to stack as the \St{fact} argument      \\
    \qquad \St{calli fact}     & ; \St{r0} contains the result for the decremented value              \\
    \qquad \St{pop r2 0}       & ; pop the value stored during the ($\star$) push to \St{r2}          \\
    \qquad \St{mul r0 r2 0}    & ; multiply the result for the decremented value by the current value \\
    \qquad \St{ret 1}          & ; return from function and remove the argument from the stack        \\

    &                                                                      \\

    \St{main:}                 &                                                                      \\
    \qquad \St{syscall r0 100} & ; read an integer from \St{stdin} to \St{r0}                         \\
    \qquad \St{push r0 0}      & ; put \St{r0+0} to the stack as the \St{fact} argument               \\
    \qquad \St{calli fact}     & ; call \St{fact}, the function will put the result to \St{r0}        \\
    \qquad \St{syscall r0 102} & ; print \St{r0} to \St{stdout}                                       \\
    \qquad \St{lc r0 10}       & ; store the constant \St{10} (`\textbackslash n') to \St{r0}         \\
    \qquad \St{syscall r0 105} & ; print `\textbackslash n' from \St{r0} to \St{stdout}               \\
    \qquad \St{lc r0 0}        & ; clear \St{r0}                                                      \\
    \qquad \St{syscall r0 0}   & ; exit the program with code \St{0}                                  \\
    \qquad \St{end main}       & ; start execution from label main                                    \\

}